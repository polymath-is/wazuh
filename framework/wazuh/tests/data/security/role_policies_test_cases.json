{
  "set_role_policy": [
    {
      "params": {
        "role_id": [
          "1"
        ],
        "policy_ids": [
          "5", "4", "6"
        ]
      },
      "result": {
        "affected_items": [],
        "failed_items": {
          "4008": [
            "1"
          ]
        }
      }
    },
    {
      "params": {
        "role_id": [
          "99"
        ],
        "policy_ids": [
          "5", "4", "6"
        ]
      },
      "result": {
        "affected_items": [],
        "failed_items": {
          "4002": [
            "99"
          ]
        }
      }
    },
    {
      "params": {
        "role_id": [
          "3"
        ],
        "policy_ids": [
          "2", "1", "8", "5", "4"
        ]
      },
      "result": {
        "affected_items": [{
          "id": 3,
          "name": "technical",
          "rule": {
            "MATCH": {
              "definition": "technicalRule"
            }
          },
          "policies": [{
            "id": 1,
            "name": "wazuhPolicy",
            "policy": {
              "actions": ["*:*"],
              "resources": ["*:*"],
              "effect": "allow"
            }
          }, {
            "id": 2,
            "name": "wazuh-wuiPolicy",
            "policy": {
              "actions": ["agent:create"],
              "effect": "allow",
              "resources": ["agent:id:001", "agent:id:002", "agent:id:003"]
            }
          }, {
            "id": 4,
            "name": "administratorPolicy",
            "policy": {
              "actions": ["agent:update", "agent:delete"],
              "effect": "allow",
              "resources": ["agent:id:*"]
            }
          }, {
            "id": 5,
            "name": "normalPolicy",
            "policy": {
              "actions": ["agent:update", "agent:delete"],
              "effect": "deny",
              "resources": ["agent:id:*"]
            }
          }, {
            "id": 8,
            "name": "policy2",
            "policy": {
              "actions": ["role:read"],
              "effect": "allow",
              "resources": ["role:id:1"]
            }
          }],
          "users": ["rbac"]
        }],
        "failed_items": {
          "4011": [
            "2", "1", "8", "5"
          ]
        }
      }
    },
    {
      "params": {
        "role_id": [
          "4"
        ],
        "policy_ids": [
          "4", "6", "99"
        ]
      },
      "result": {
        "affected_items": [{
          "id": 4,
          "name": "administrator",
          "rule": {
            "MATCH": {
              "definition": "administratorRule"
            }
          },
          "policies": [{
            "id": 4,
            "name": "administratorPolicy",
            "policy": {
              "actions": ["agent:update", "agent:delete"],
              "effect": "allow",
              "resources": ["agent:id:*"]
            }
          }, {
            "id": 5,
            "name": "normalPolicy",
            "policy": {
              "actions": ["agent:update", "agent:delete"],
              "effect": "deny",
              "resources": ["agent:id:*"]
            }
          }, {
            "id": 6,
            "name": "ossecPolicy",
            "policy": {
              "actions": ["role:read"],
              "effect": "allow",
              "resources": ["role:id:*"]
            }
          }],
          "users": ["normal", "rbac"]
        }],
        "failed_items": {
          "4007": [
            "99"
          ],
          "4011": [
            "4"
          ]
        }
      }
    }
  ],
  "remove_role_policy": [
    {
      "params": {
        "role_id": [
          "1"
        ],
        "policy_ids": [
          "5", "4", "6"
        ]
      },
      "result": {
        "affected_items": [],
        "failed_items": {
          "4008": [
            "1"
          ]
        }
      }
    },
    {
      "params": {
        "role_id": [
          "99"
        ],
        "policy_ids": [
          "5", "4", "6"
        ]
      },
      "result": {
        "affected_items": [],
        "failed_items": {
          "4002": [
            "99"
          ]
        }
      }
    },
    {
      "params": {
        "role_id": [
          "3"
        ],
        "policy_ids": [
          "5", "4", "6"
        ]
      },
      "result": {
        "affected_items": [{
          "id": 3,
          "name": "technical",
          "rule": {
            "MATCH": {
              "definition": "technicalRule"
            }
          },
          "policies": [{
            "id": 1,
            "name": "wazuhPolicy",
            "policy": {
              "actions": ["*:*"],
              "resources": ["*:*"],
              "effect": "allow"
            }
          }, {
            "id": 2,
            "name": "wazuh-wuiPolicy",
            "policy": {
              "actions": ["agent:create"],
              "effect": "allow",
              "resources": ["agent:id:001", "agent:id:002", "agent:id:003"]
            }
          }, {
            "id": 8,
            "name": "policy2",
            "policy": {
              "actions": ["role:read"],
              "effect": "allow",
              "resources": ["role:id:1"]
            }
          }],
          "users": ["rbac"]
        }],
        "failed_items": {
          "4010": [
            "4", "6"
          ]
        }
      }
    },
    {
      "params": {
        "role_id": [
          "6"
        ],
        "policy_ids": [
          "2", "5", "6", "16"
        ]
      },
      "result": {
        "affected_items": [
          {
            "id": 6,
            "name": "ossec",
            "policies": [
              {
                "id": 1,
                "name": "wazuhPolicy",
                "policy": {
                  "actions": [
                    "*:*"
                  ],
                  "effect": "allow",
                  "resources": [
                    "*:*"
                  ]
                }
              },
              {
                "id": 3,
                "name": "technicalPolicy",
                "policy": {
                  "actions": [
                    "agent:create"
                  ],
                  "effect": "allow",
                  "resources": [
                    "*:*:*"
                  ]
                }
              },
              {
                "id": 4,
                "name": "administratorPolicy",
                "policy": {
                  "actions": [
                    "agent:update",
                    "agent:delete"
                  ],
                  "effect": "allow",
                  "resources": [
                    "agent:id:*"
                  ]
                }
              },
              {
                "id": 7,
                "name": "policy1",
                "policy": {
                  "actions": [
                    "role:read"
                  ],
                  "effect": "deny",
                  "resources": [
                    "role:id:*"
                  ]
                }
              },
              {
                "id": 8,
                "name": "policy2",
                "policy": {
                  "actions": [
                    "role:read"
                  ],
                  "effect": "allow",
                  "resources": [
                    "role:id:1"
                  ]
                }
              },
              {
                "id": 9,
                "name": "policy3",
                "policy": {
                  "actions": [
                    "policy:read"
                  ],
                  "effect": "allow",
                  "resources": [
                    "policy:id:1"
                  ]
                }
              },
              {
                "id": 10,
                "name": "policy4",
                "policy": {
                  "actions": [
                    "policy:delete"
                  ],
                  "effect": "deny",
                  "resources": [
                    "policy:id:*"
                  ]
                }
              }
            ],
            "rule": {
              "MATCH": {
                "definition": "ossecRule"
              }
            },
            "users": [
              "normal"
            ]
          }
        ],
        "failed_items": {
          "4007": [
            "16"
          ],
          "4010": [
            "2", "6"
          ]
        }
      }
    }
  ]
}
