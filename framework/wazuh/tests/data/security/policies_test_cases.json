{
  "get_policies": [
    {
      "params": {
        "policy_ids": [
          "1", "4"
        ]
      },
      "result": {
        "affected_items": [{
          "id": 1,
          "name": "wazuhPolicy",
          "policy": {
            "actions": ["*:*"],
            "resources": ["*:*"],
            "effect": "allow"
          },
          "roles": [{
            "id": 1,
            "name": "wazuh",
            "rule": {
              "FIND": {
                "r'^auth[a-zA-Z]+$'": ["administrator"]
              }
            }
          }, {
            "id": 2,
            "name": "wazuh-wui",
            "rule": {
              "FIND": {
                "r'^auth[a-zA-Z]+$'": ["administrator-app"]
              }
            }
          }, {
            "id": 3,
            "name": "technical",
            "rule": {
              "MATCH": {
                "definition": "technicalRule"
              }
            }
          }, {
            "id": 6,
            "name": "ossec",
            "rule": {
              "MATCH": {
                "definition": "ossecRule"
              }
            }
          }]
        }, {
          "id": 4,
          "name": "administratorPolicy",
          "policy": {
            "actions": ["agent:update", "agent:delete"],
            "effect": "allow",
            "resources": ["agent:id:*"]
          },
          "roles": [{
            "id": 4,
            "name": "administrator",
            "rule": {
              "MATCH": {
                "definition": "administratorRule"
              }
            }
          }, {
            "id": 6,
            "name": "ossec",
            "rule": {
              "MATCH": {
                "definition": "ossecRule"
              }
            }
          }]
        }],
        "failed_items": {}
      }
    },
    {
      "params": {
        "policy_ids": [
          "3", "5", "6", "11"
        ]
      },
      "result": {
        "affected_items": [{
          "id": 3,
          "name": "technicalPolicy",
          "policy": {
            "actions": ["agent:create"],
            "effect": "allow",
            "resources": ["*:*:*"]
          },
          "roles": [{
            "id": 5,
            "name": "normalUser",
            "rule": {
              "MATCH": {
                "definition": "normalRule"
              }
            }
          }, {
            "id": 6,
            "name": "ossec",
            "rule": {
              "MATCH": {
                "definition": "ossecRule"
              }
            }
          }]
        }, {
          "id": 5,
          "name": "normalPolicy",
          "policy": {
            "actions": ["agent:update", "agent:delete"],
            "effect": "deny",
            "resources": ["agent:id:*"]
          },
          "roles": [{
            "id": 3,
            "name": "technical",
            "rule": {
              "MATCH": {
                "definition": "technicalRule"
              }
            }
          }, {
            "id": 4,
            "name": "administrator",
            "rule": {
              "MATCH": {
                "definition": "administratorRule"
              }
            }
          }, {
            "id": 6,
            "name": "ossec",
            "rule": {
              "MATCH": {
                "definition": "ossecRule"
              }
            }
          }]
        }, {
          "id": 6,
          "name": "ossecPolicy",
          "policy": {
            "actions": ["role:read"],
            "effect": "allow",
            "resources": ["role:id:*"]
          },
          "roles": [{
            "id": 6,
            "name": "ossec",
            "rule": {
              "MATCH": {
                "definition": "ossecRule"
              }
            }
          }]
        }],
        "failed_items": {
          "4007": [
            "11"
          ]
        }
      }
    },
    {
      "params": {
        "policy_ids": [
          "11", "12", "13"
        ]
      },
      "result": {
        "affected_items": [],
        "failed_items": {
          "4007": [
            "11", "12", "13"
          ]
        }
      }
    }
  ],
  "add_policy": [
    {
      "params": {
        "name": "new_policy",
        "policy": {
          "actions": [
              "agent:delete"
            ],
            "effect": "allow",
            "resources": [
              "agent:id:099"
            ]
        }
      },
      "result": {
        "affected_items": [{
          "id": 11,
          "name": "new_policy",
          "policy": {
            "actions": ["agent:delete"],
            "effect": "allow",
            "resources": ["agent:id:099"]
          },
          "roles": []
        }],
        "failed_items": {}
      }
    },
    {
      "params": {
        "name": "ossecPolicy",
        "policy": {
          "actions": [
              "agent:delete"
            ],
            "effect": "allow",
            "resources": [
              "agent:id:098"
            ]
        }
      },
      "result": {
        "affected_items": [],
        "failed_items": {
          "4009": [
            "ossecPolicy"
          ]
        }
      }
    },
    {
      "params": {
        "name": "wazuhPolicy",
        "policy": {
          "actions": [
              "agent:delete"
            ],
            "effect": "allow",
            "resources": [
              "agent:id:097"
            ]
        }
      },
      "result": {
        "affected_items": [],
        "failed_items": {
          "4009": [
            "wazuhPolicy"
          ]
        }
      }
    }
  ],
  "update_policy": [
    {
      "params": {
        "policy_id": ["6"]
      },
      "result": {
        "affected_items": [],
        "failed_items": {
          "4001": [
            "6"
          ]
        }
      }
    },
    {
      "params": {
        "policy_id": ["6"],
        "name": "ossecPolicy1",
        "policy": {
          "actions": [
              "agent:delete"
            ],
            "effect": "allow",
            "resources": [
              "agent:id:097"
            ]
        }
      },
      "result": {
        "affected_items": [{
          "id": 6,
          "name": "ossecPolicy1",
          "policy": {
            "actions": ["agent:delete"],
            "effect": "allow",
            "resources": ["agent:id:097"]
          },
          "roles": [{
            "id": 6,
            "name": "ossec",
            "rule": {
              "MATCH": {
                "definition": "ossecRule"
              }
            }
          }]
        }],
        "failed_items": {}
      }
    },
    {
      "params": {
        "policy_id": ["25"],
        "name": "normalPolicy2",
        "policy": {
          "actions": [
              "agent:delete"
            ],
            "effect": "allow",
            "resources": [
              "agent:id:098"
            ]
        }
      },
      "result": {
        "affected_items": [],
        "failed_items": {
          "4007": [
            "25"
          ]
        }
      }
    },
    {
      "params": {
        "policy_id": ["4"],
        "name": "administratorPolicy",
        "policy": {
          "actions": [
              "agent:delete"
            ],
            "effect": "allow",
            "resources": [
              "agent:id:097"
            ]
        }
      },
      "result": {
        "affected_items": [],
        "failed_items": {
          "4013": [
            "4"
          ]
        }
      }
    },
    {
      "params": {
        "policy_id": ["1"],
        "name": "wazuhPolicy",
        "policy": {
          "actions": [
              "agent:delete"
            ],
            "effect": "allow",
            "resources": [
              "agent:id:099"
            ]
        }
      },
      "result": {
        "affected_items": [],
        "failed_items": {
          "4008": [
            "1"
          ]
        }
      }
    }
  ],
  "remove_policies": [
    {
      "params": {
        "policy_ids": [
          "1", "4"
        ]
      },
      "result": {
        "affected_items": [{
          "id": 4,
          "name": "administratorPolicy",
          "policy": {
            "actions": ["agent:update", "agent:delete"],
            "effect": "allow",
            "resources": ["agent:id:*"]
          },
          "roles": [{
            "id": 4,
            "name": "administrator",
            "rule": {
              "MATCH": {
                "definition": "administratorRule"
              }
            }
          }, {
            "id": 6,
            "name": "ossec",
            "rule": {
              "MATCH": {
                "definition": "ossecRule"
              }
            }
          }]
        }],
        "failed_items": {
          "4008": [
            "1"
          ]
        }
      }
    },
    {
      "params": {
        "policy_ids": [
          "3", "5", "6", "13"
        ]
      },
      "result": {
        "affected_items": [{
          "id": 3,
          "name": "technicalPolicy",
          "policy": {
            "actions": ["agent:create"],
            "effect": "allow",
            "resources": ["*:*:*"]
          },
          "roles": [{
            "id": 5,
            "name": "normalUser",
            "rule": {
              "MATCH": {
                "definition": "normalRule"
              }
            }
          }, {
            "id": 6,
            "name": "ossec",
            "rule": {
              "MATCH": {
                "definition": "ossecRule"
              }
            }
          }]
        }, {
          "id": 5,
          "name": "normalPolicy",
          "policy": {
            "actions": ["agent:update", "agent:delete"],
            "effect": "deny",
            "resources": ["agent:id:*"]
          },
          "roles": [{
            "id": 3,
            "name": "technical",
            "rule": {
              "MATCH": {
                "definition": "technicalRule"
              }
            }
          }, {
            "id": 4,
            "name": "administrator",
            "rule": {
              "MATCH": {
                "definition": "administratorRule"
              }
            }
          }, {
            "id": 6,
            "name": "ossec",
            "rule": {
              "MATCH": {
                "definition": "ossecRule"
              }
            }
          }]
        }, {
          "id": 6,
          "name": "ossecPolicy",
          "policy": {
            "actions": ["role:read"],
            "effect": "allow",
            "resources": ["role:id:*"]
          },
          "roles": [{
            "id": 6,
            "name": "ossec",
            "rule": {
              "MATCH": {
                "definition": "ossecRule"
              }
            }
          }]
        }],
        "failed_items": {
          "4007": [
            "13"
          ]
        }
      }
    },
    {
      "params": {
        "policy_ids": [
          "10", "11", "12"
        ]
      },
      "result": {
        "affected_items": [{
          "id": 10,
          "name": "policy4",
          "policy": {
            "actions": ["policy:delete"],
            "effect": "deny",
            "resources": ["policy:id:*"]
          },
          "roles": [{
            "id": 5,
            "name": "normalUser",
            "rule": {
              "MATCH": {
                "definition": "normalRule"
              }
            }
          }, {
            "id": 6,
            "name": "ossec",
            "rule": {
              "MATCH": {
                "definition": "ossecRule"
              }
            }
          }]
        }],
        "failed_items": {
          "4007": [
            "11", "12"
          ]
        }
      }
    }
  ]
}
